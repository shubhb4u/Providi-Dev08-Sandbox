(window._walkmeShieldWebpackJP_=window._walkmeShieldWebpackJP_||[]).push([[2],{123:function(e,t,n){"use strict";var r=n(124),i=n(154);t.a={generate:function(e){e.forEach((function(e){Object.keys(e.Flow.Nodes).forEach((function(t){var n=e.Flow.Nodes[t];n.Settings.actionArgs&&n.Settings.actionArgs.fillTextMethod&&(n.Settings.actionArgs.fillText=function(e){var t=e.fillTextMethod===r.fillTextMethod.RANDOM?{length:8,prefix:"test",lowercase:!0,uppercase:!0,digits:!0}:e.fillTextCustomOptions;if(!t)return"";return(t.prefix||"")+new i(function(e){if(e.regex)return e.regex;var t="";e.uppercase&&(t+="A-Z");e.lowercase&&(t+="a-z");e.digits&&(t+="0-9");e.symbols&&(t+="!@#$%^&*()+_");return"[".concat(t,"]{").concat(e.length,"}")}(t)).gen()}(n.Settings.actionArgs))}))}))}}},159:function(e,t,n){"use strict";(function(e){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,"a",(function(){return i}));var i=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.eventSender=e}var n,i,o;return n=t,(i=[{key:"sendMessage",value:function(e,t){this.eventSender.send("message",{timestamp:Date.now(),event:e},t)}},{key:"sendDone",value:function(e,t){this.eventSender.send("done",e,t)}},{key:"sendStart",value:function(e,t){this.eventSender.send("start",e,t)}},{key:"sendError",value:function(e,t){var n=e instanceof Error?e:new Error(e||"unknown error");this.eventSender.send("error",{data:n},t)}},{key:"sendMessageWithResponse",value:function(t,n){var r=this;return new e((function(e){n.resolve=e,r.sendMessage(t,n)}))}}])&&r(n.prototype,i),o&&r(n,o),t}()}).call(this,n(3).Promise)},160:function(e,t,n){"use strict";var r=n(5);t.a={get:function(){var e=r.b.deps.consts,t=r.b.deps.deployableTypes,n=[{key:e.EVENTS.Flows.FlowStarted},{key:e.EVENTS.Flows.FlowStopped},{key:e.EVENTS.Flows.FlowAborted},{key:e.EVENTS.Flows.FlowCompleted},{key:e.EVENTS.Flows.FlowBranched},{key:e.EVENTS.Flows.UiElementFound,action:{takeScreenshot:!0}},{key:e.EVENTS.Flows.AfterCompletingFlowStage,action:{takeScreenshot:!0},actionFilterFunc:function(t){return t.step.Type!==e.FLOW_STEP_TYPE.UI&&t.step.ActionType!==e.FLOW_ACTION_TYPE.OnPageAction}},{key:e.EVENTS.Flows.FlowStageSkipped,action:{takeScreenshot:!0}},{key:e.EVENTS.Flows.BeforeExecutingFlowStage},{key:e.EVENTS.Flows.WaitForConditionEvaluated},{key:e.EVENTS.Flows.BeforeFlowStarted},{key:e.EVENTS.Flows.UIFlowStageShown},{key:e.EVENTS.Flows.LookingForElement}],i=n.map((function(t){return{key:e.SHIELD.INSTANCE_PARAMS.eventPrefix+t.key,action:t.action,actionFilterFunc:t.actionFilterFunc}})),o=[{key:e.EVENTS.Launchers.LauncherClicked},{key:e.EVENTS.SmartTips.TooltipShown}];return n.concat(i).concat([{key:e.EVENTS.Goals.GoalReached,filterFunc:function(e){return[t.ShieldTestCase,t.BusinessSolution].includes(e.goal.GoalType)},action:{takeScreenshot:!0}}]).concat(o)}}},161:function(e,t,n){"use strict";var r=n(0);t.a={adapt:function(e){var t=e.Flow,n=t.RootFlowNodeId,i=t.Nodes[n],o=i.ActionType,s=i.Name;if(o===r.b.SWITCH_TO_FRAME_ACTION_TYPE){var a,c,l=(a=n,c=s,{ActionType:r.b.WAIT_FOR_ACTION_TYPE,ConditionTrees:{WaitFor:{Id:0,Notes:null,ConditionType:"WaitFor"}},Guid:r.c,Id:r.c,Links:[{EditorSettings:{},TargetFlowNodeId:a}],Name:c,Notes:null,PointIndex:0,Settings:{actionArgs:{}},Type:"Action"}),u=l.Id;t.RootFlowNodeId=u,t.Nodes[u]=l}},shouldFilterEvent:function(e){return e.step&&e.step.Id===r.c}}},162:function(e,t,n){"use strict";var r=n(0);t.a={adapt:function(e){var t;if(null==e?void 0:e.step){var n=JSON.parse(JSON.stringify(e.step)),i=null===(t=n.Settings)||void 0===t?void 0:t.actionArgs;if(i){var o=i.secure;i.onElementAction===r.e.FILL_TEXT&&o&&(i.fillText=r.g),e.step=n}}}}},163:function(e,t,n){"use strict";var r,i=n(33),o=n(5),s=n(18);function a(){var e;r=new s.a(".shield-smartTips-dismiss"),e=o.b.deps.consts,r.onEvent(e.EVENTS.SmartTips.TooltipShown,(function(t,n){var i=n.smartTipModel.Id,o=l(i);r.onEventOnce("Shield"+e.EVENTS.Flows.BeforeExecutingFlowStage,(function(){o=l(i,o),r.onEventOnce("Shield"+e.EVENTS.Flows.AfterCompletingFlowStage,(function(){c(i),o.clear()}))}))}))}function c(e){return wmjQuery('[data-wm-edit-from-preview-inner-id="'+e+'"]').trigger("mouseout")}function l(e,t){var n=o.b.deps.timerManager;return t&&t.clear(),t=n.setWalkmeTimeout((function(){return c(e)}),3e3)}function u(e){i.c(e),a()}function d(){i.d(),r.destroy()}n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}))},17:function(e,t,n){"use strict";var r=n(5),i=n(0);t.a={info:function(e,t,n){if(e){for(var o=arguments.length,s=new Array(o>3?o-3:0),a=3;a<o;a++)s[a-3]=arguments[a];e.info.apply(e,[t,n].concat(s))}else r.b.deps.logger.customerLog(n,i.d.LOG_LEVEL_STR_TO_NUM.INFO,i.d.LOG_FEATURE_NAME)},debug:function(e,t,n){if(e){for(var o=arguments.length,s=new Array(o>3?o-3:0),a=3;a<o;a++)s[a-3]=arguments[a];e.debug.apply(e,[t,n].concat(s))}else r.b.deps.logger.customerLog(n,i.d.LOG_LEVEL_STR_TO_NUM.DEBUG,i.d.LOG_FEATURE_NAME)},error:function(e,t,n,o,s){try{if(e){for(var a=arguments.length,c=new Array(a>5?a-5:0),l=5;l<a;l++)c[l-5]=arguments[l];e.error.apply(e,[t,n,o].concat(c))}else r.b.deps.logger.customerLog(o.message,i.d.LOG_LEVEL_STR_TO_NUM.ERROR,i.d.LOG_FEATURE_NAME);var u=r.b.getCtxDependency("EventSenderErrorLogger");if(!s&&u&&"function"==typeof u.logError){o.message="".concat(i.d.LOG_FEATURE_NAME,"(e): ").concat(o.message);var d,f=o.stack&&o.stack.split("\n");d=f&&f.length?f.slice(0,i.d.LOG_STACK_MAX_LENGTH).join("\n"):o.message,u.logError(d,{group:i.d.LOG_GROUP_NAME,project:i.d.LOG_PROJECT_NAME,component:i.d.LOG_COMPONENT_NAME})}}catch(e){console.error(e)}}}},18:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));var r=n(5);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.events=[],this.prefix=e,this.instanceParams=r.b.deps.consts.SHIELD.INSTANCE_PARAMS}var n,o,s;return n=t,(o=[{key:"onShieldEventOnce",value:function(e,t){this.onEventOnce(this.instanceParams.eventPrefix+e,t)}},{key:"onShieldEventsOnce",value:function(e,t){var n=this,r=e.map((function(e){return n.instanceParams.eventPrefix+e}));this.onEventOnce(r.join(" "),t)}},{key:"onShieldEvents",value:function(e,t){var n=this,r=e.map((function(e){return n.instanceParams.eventPrefix+e}));this.onEvent(r.join(" "),t)}},{key:"onEvents",value:function(e,t){this.onEvent(e.join(" "),t)}},{key:"onShieldEvent",value:function(e,t){this.onEvent(this.instanceParams.eventPrefix+e,t)}},{key:"onEventsOnce",value:function(e,t){this.onEventOnce(e.join(" "),t)}},{key:"onEventOnce",value:function(e,t){r.b.deps.wmInternals.one(e+this.prefix,t),this.events.push(e)}},{key:"onEvent",value:function(e,t){r.b.deps.wmInternals.on(e+this.prefix,t),this.events.push(e)}},{key:"destroy",value:function(){var t=!0,n=!1,i=void 0;try{for(var o,s=this.events[e]();!(t=(o=s.next()).done);t=!0){var a=o.value;r.b.deps.wmInternals.off(a+this.prefix)}}catch(e){n=!0,i=e}finally{try{t||null==s.return||s.return()}finally{if(n)throw i}}}}])&&i(n.prototype,o),s&&i(n,s),t}()}).call(this,n(22))},2:function(e,t,n){"use strict";n.r(t),function(e,r){var i,o,s,a=n(5),c=n(64),l=n(33);function u(t,n,r,i,o,s,a){try{var c=t[s](a),l=c.value}catch(e){return void r(e)}c.done?n(l):e.resolve(l).then(i,o)}t.default={init:(o=r.mark((function e(t){var n,o=this;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.b.init(t),a.b.deps.wmInternals.shieldApp=this,n=a.b.deps.consts.SHIELD.INSTANCE_PARAMS,a.b.deps.ownershipManagerProvider.addExtra(a.b.deps.bizflowOwnershipManager,n),a.b.deps.bizFlowOnBeforeUnloadChecker.addExtra(n),a.b.deps.deployablesRestorer.addRestorer(n.type,{restore:function(){a.b.deps.flowDataServicesProvider.getFlowStack(n).load(),a.b.trigger(a.a.SHIELD_RESTORE,{app:o})}},!1,!0),a.b.deps.deployablesManagerFactory&&a.b.deps.deployablesManagerFactory.add(a.b.deps.deployableTypes.ShieldTestCase,{name:function(){return"Shield"},getById:function(e){if(i&&i.data&&i.data.shieldTests)return i.data.shieldTests.find((function(t){return t.Id===e}))},getAll:function(){return i&&i.data&&i.data.shieldTests||[]}}),l.b(),a.b.trigger(a.a.SHIELD_READY,{app:this});case 9:case"end":return e.stop()}}),e,this)})),s=function(){var t=this,n=arguments;return new e((function(e,r){var i=o.apply(t,n);function s(t){u(i,e,r,s,a,"next",t)}function a(t){u(i,e,r,s,a,"throw",t)}s(void 0)}))},function(e){return s.apply(this,arguments)}),createTester:function(e){var t=e.data,n=e.options,r=void 0===n?{}:n;return i=new c.a(t,r)}}}.call(this,n(3).Promise,n(12))},3:function(e,t){e.exports={get Promise(){if(window.Promise&&"function"==typeof window.Promise.toString){var e=window.Promise.toString();if("string"==typeof e&&e.indexOf("[native code]")>-1)return window.Promise}return window._walkmeInternals&&window._walkmeInternals.ctx&&"function"==typeof window._walkmeInternals.ctx.get?window._walkmeInternals.ctx.get("PromiseManager").Promise:{then:function(e){return"function"==typeof e&&e(),this},catch:function(){return this}}}}},33:function(e,t,n){"use strict";n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return w})),n.d(t,"a",(function(){return m}));var r,i,o,s,a,c,l,u,d=n(17),f=n(5),E=n(18),p=n(0),h=5e3;function g(){var e=f.b.deps,t=e.consts;e.flowTransitionChecker.register(t.FLOW_TRANSITION_HANDLER_IDS.DELAYER,m,t.SHIELD.INSTANCE_PARAMS)}function v(e){l=e,d.a.debug(l,p.d.FEATURES.SCHEDULING,"starting playTransitionScheduler"),c=new Set;var t=f.b.deps.consts,n=[t.EVENTS.Flows.FlowStarted,t.EVENTS.Flows.RestoringFlow],i=[t.EVENTS.Flows.FlowPaused,t.EVENTS.Flows.FlowAborted,t.EVENTS.Flows.FlowStopped,t.EVENTS.Flows.FlowCompleted],s=[t.EVENTS.Flows.BeforeExecutingFlowStage,t.EVENTS.Flows.FlowStageSkipped,t.EVENTS.Flows.AfterCompletingFlowStage],a=[t.EVENTS.Flows.UIFlowStageShown];(r=new E.a(".shield-transition")).onEvents(n,(function(e,t){d.a.info(l,p.d.FEATURES.SCHEDULING,"smart walkthru started. flowId",t.flowId),u=!1,c.add(t.flowId)})),r.onEvents(i,(function(e,t){d.a.info(l,p.d.FEATURES.SCHEDULING,"smart walkthru finished. flowId",t.flowId),u=!1,c.delete(t.flowId)})),r.onEvents(s,(function(e,t){d.a.info(l,p.d.FEATURES.SCHEDULING,"got smart walkthru red event. starting a timeout ",e.type),u=!1,T(1e3*function(e){var t=f.b.deps.consts,n=e.step.Settings.actionArgs&&e.step.Settings.actionArgs.Duration;if(!n){var r=e.step.UIElements&&e.step.UIElements[0]&&e.step.UIElements[0].Triggers.find((function(e){return e.Type===t.FLOW_TRIGGER_TYPE.Delay}));r&&(n=r.Settings.Duration)}return n?n+1:0}(t))})),r.onEvents(a,(function(e){d.a.info(l,p.d.FEATURES.SCHEDULING,"got smart walkthru green event. starting an extra timeout of ".concat(p.i,"ms"),e.type),u=!0,y(),o=f.b.deps.timerManager.setWalkmeTimeout(F,p.i)})),A()}function w(){d.a.debug(l,p.d.FEATURES.SCHEDULING,"stopping playTransitionScheduler"),u=!1,r&&(r.destroy(),r=void 0),S(),c&&c.clear(),a&&F(!0),l=void 0}function S(){s&&(s.clear(),s=void 0),o&&(o.clear(),o=void 0)}function m(){return d.a.info(l,p.d.FEATURES.SCHEDULING,"checking when next test step can continue"),A(),c.size>0?i||T(u?p.i:h):(d.a.info(l,p.d.FEATURES.SCHEDULING,"no smart walkthru is running, waiting extra ".concat(p.i,"ms")),s=f.b.deps.timerManager.setWalkmeTimeout(F,p.i)),a.promise()}function T(e){S(),y(),i=f.b.deps.timerManager.setWalkmeTimeout((function(){i=void 0,F()}),e||h)}function y(){i&&(i.clear(),i=void 0)}function F(e){a&&(e?a.reject():a.resolve(),a=void 0)}function A(){a||(a=wmjQuery.Deferred())}},34:function(e,t,n){"use strict";(function(e){var r=n(5);t.a={create:function(){var t=void 0,n=new e((function(e){return t=e}));return r.b.deps.wmInternals.shieldApp.waitPromises.push(n),{clean:function(){t();var e=r.b.deps.wmInternals.shieldApp.waitPromises.indexOf(n);r.b.deps.wmInternals.shieldApp.waitPromises.splice(e,1)}}}}}).call(this,n(3).Promise)},5:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={SHIELD_READY:"shield.ready",SHIELD_RESTORE:"shield.restore"};t.b={init:function(e){this.deps=e;var t=this.deps.newApiEventsConfigProvider;t&&(t.set(r.SHIELD_READY,{}),t.set(r.SHIELD_RESTORE,{}))},on:function(){var e;(e=this.deps.wmInternals).on.apply(e,arguments)},off:function(){var e;(e=this.deps.wmInternals).off.apply(e,arguments)},trigger:function(){var e;(e=this.deps.commonEvents).raiseEvent.apply(e,arguments)},getCtxDependency:function(e){return this.deps&&this.deps.wmInternals&&this.deps.wmInternals.ctx&&"function"==typeof this.deps.wmInternals.ctx.get&&this.deps.wmInternals.ctx.has(e)&&this.deps.wmInternals.ctx.get(e)},getEventServerUrl:function(){return this.getCtxDependency("SettingsFile")&&this.getCtxDependency("SettingsFile").getSettingsFile()&&this.getCtxDependency("SettingsFile").getSettingsFile().EventServer}}},54:function(e,t,n){"use strict";(function(e,r){var i=n(5);function o(t,n,r,i,o,s,a){try{var c=t[s](a),l=c.value}catch(e){return void r(e)}c.done?n(l):e.resolve(l).then(i,o)}var s,a,c=function(e){return"".concat("wm-shield-").concat(e)};t.a={getItem:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=c(e);return t?i.b.deps.clientStorageManager.getData(n):JSON.parse(localStorage.getItem(n))},setItem:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:600,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=c(e);return r?i.b.deps.clientStorageManager.saveData(o,t,n):localStorage.setItem(o,JSON.stringify(t))},removeItem:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=c(e);return t?i.b.deps.clientStorageManager.removeData(n):localStorage.removeItem(n)},sync:(s=r.mark((function t(){var n=arguments;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n.length>0&&void 0!==n[0])||n[0]){t.next=3;break}return t.abrupt("return");case 3:return t.abrupt("return",new e((function(e){i.b.deps.clientStorageManager.refreshGetData(null,(function(){e()}))})));case 4:case"end":return t.stop()}}),t)})),a=function(){var t=this,n=arguments;return new e((function(e,r){var i=s.apply(t,n);function a(t){o(i,e,r,a,c,"next",t)}function c(t){o(i,e,r,a,c,"throw",t)}a(void 0)}))},function(){return a.apply(this,arguments)})}}).call(this,n(3).Promise,n(12))},64:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=n(65).Tester},65:function(e,t,n){"use strict";n.r(t),function(e,r,i){n.d(t,"Tester",(function(){return T}));var o=n(17),s=n(54),a=n(5),c=n(0),l=n(97),u=n(123),d=n(159),f=n(160),E=n(18),p=n(34),h=n(163),g=n(161),v=n(162);function w(t,n,r,i,o,s,a){try{var c=t[s](a),l=c.value}catch(e){return void r(e)}c.done?n(l):e.resolve(l).then(i,o)}function S(t){return function(){var n=this,r=arguments;return new e((function(e,i){var o=t.apply(n,r);function s(t){w(o,e,i,s,a,"next",t)}function a(t){w(o,e,i,s,a,"throw",t)}s(void 0)}))}}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var T=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=t,this.eventSender=new d.a(n.eventSender),this.shieldLogger=n.logger,a.b.deps.wmInternals.shieldApp.waitPromises=[]}var t,n,w,T,y;return t=e,(n=[{key:"isRunning",value:function(){return this.isTestRunning}},{key:"play",value:(y=S(r.mark((function e(t){var n,i,a,d,f,E;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.isTestRunning=!0,o.a.info(this.shieldLogger,c.d.FEATURES.SETUP,"start tester. restore = ",t),n=this.data,i=n.shieldTest,a=n.startingNodeId,d=n.shieldTests,u.a.generate(d),g.a.adapt(i),t||(s.a.setItem(c.j,(new Date).getTime()),f=this.getHostData(),this.eventSender.sendStart(f)),h.a(this.shieldLogger),e.next=10,l.a.play({shieldTest:i,restore:t,startingNodeId:a,shieldLogger:this.shieldLogger,settings:this.data.settings,isRunningFunc:this.isRunning.bind(this)});case 10:return E=e.sent,h.b(),this.isTestRunning=!1,o.a.info(this.shieldLogger,c.d.FEATURES.PLAY,"playResult = ",JSON.stringify(E)),E.switchedContext?this.destroyEventsListener():(this.eventSender.sendDone({succeed:E.success,execTime:(new Date).getTime()-s.a.getItem(c.j)},{takeScreenshot:!0}),this.dispose()),e.abrupt("return",E);case 18:e.prev=18,e.t0=e.catch(0),this.isTestRunning=!1,o.a.error(this.shieldLogger,c.d.FEATURES.SETUP,"error in end user setup",e.t0),this.eventSender.sendError(e.t0,{takeScreenshot:!0}),h.b(),this.dispose();case 25:case"end":return e.stop()}}),e,this,[[0,18]])}))),function(e){return y.apply(this,arguments)})},{key:"recordWalkmeEvents",value:function(e){var t=this;if(this.walkmeEventsListener){if(e)return;this.walkmeEventsListener.destroy()}o.a.info(this.shieldLogger,c.d.FEATURES.PLAY,"record walkme events"),this.walkmeEventsListener=new E.a(".shield-all-events");var n=!0,r=!1,s=void 0;try{for(var a,l=function(){var e=a.value;t.walkmeEventsListener.onEvent(e.key,(function(n,r){try{if(o.a.debug(t.shieldLogger,c.d.FEATURES.PLAY,"".concat(n.type," triggered"),r),e.filterFunc&&!e.filterFunc(r)||g.a.shouldFilterEvent(r))return;v.a.adapt(r);var i={type:n.type,data:r};return!e.action||e.actionFilterFunc&&!e.actionFilterFunc(r)?t.eventSender.sendMessage(i):t.sendMessageWithResponse(i,e.action)}catch(e){o.a.error(t.shieldLogger,c.d.FEATURES.PLAY,"error in processing play event",e)}}))},u=f.a.get()[i]();!(n=(a=u.next()).done);n=!0)l()}catch(e){r=!0,s=e}finally{try{n||null==u.return||u.return()}finally{if(r)throw s}}}},{key:"sendMessageWithResponse",value:(T=S(r.mark((function e(t,n){var i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=p.a.create(),e.prev=1,e.next=4,this.eventSender.sendMessageWithResponse(t,n);case 4:return e.abrupt("return",e.sent);case 5:return e.prev=5,i.clean(),e.finish(5);case 8:case"end":return e.stop()}}),e,this,[[1,,5,8]])}))),function(e,t){return T.apply(this,arguments)})},{key:"getHostData",value:function(){return{browser:a.b.deps.hostData.getBrowserData().string,os:a.b.deps.hostData.getOSData().name,screenResolution:window.screen.width*(window.devicePixelRatio||1)+"x"+window.screen.height*(window.devicePixelRatio||1),walkmeLanguage:a.b.deps.languageManager.getCurrentLanguage()}}},{key:"dispose",value:function(){this.isTestRunning=!1,s.a.removeItem(c.j),s.a.removeItem("shield-in-testing"),s.a.removeItem(c.h),this.destroyEventsListener()}},{key:"destroyEventsListener",value:function(){this.walkmeEventsListener&&(this.walkmeEventsListener.destroy(),this.walkmeEventsListener=void 0)}}])&&m(t.prototype,n),w&&m(t,w),e}()}.call(this,n(3).Promise,n(12),n(22))},97:function(e,t,n){"use strict";(function(e){var r,i,o,s=n(17),a=n(5),c=n(18),l=n(0),u=n(54),d=n(33),f=n(98),E=n(34),p=n(100);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var v=l.f,w=500;function S(t,n,r,o,c,u){var d=a.b.deps.timerManager;T(),y(),c?function(t,n){return new e((function(e){var r=a.b.deps,o=r.consts,c=r.flowDataServicesProvider,u=r.timerManager,d=c.getFlowStack();d.load(),d.isEmpty()?u.setWalkmeTimeout(e,w):(s.a.info(n,l.d.FEATURES.PLAY,"waiting max ".concat(v,"ms for the smart walkthru to finish"),d.peek()),i=u.setWalkmeTimeout((function(){s.a.info(n,l.d.FEATURES.PLAY,"smart walkthru timeout passed"),y(),e(!0)}),v),t.onEventsOnce([o.EVENTS.Flows.FlowCompleted,o.EVENTS.Flows.FlowAborted,o.EVENTS.Flows.FlowStopped],(function(){s.a.info(n,l.d.FEATURES.PLAY,"smart walkthru finished"),y(),e()})))}))}(n,t).then((function(e){u(),r(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},o,{shouldStopSmartWalkthru:e}))})):d.setWalkmeTimeout((function(){r(o)}),w)}function m(e,t,n){T(),r=e.setWalkmeTimeout((function(){r=void 0,t.getFlowsPlayer(n).stop()}),v)}function T(){r&&(r.clear(),r=void 0)}function y(){o&&o.destroy(),i&&(i.clear(),i=void 0)}t.a={play:function(t){var n=t.shieldTest,r=t.restore,i=t.startingNodeId,h=t.shieldLogger,g=t.settings,w=t.isRunningFunc,F=a.b.deps,A=F.consts,b=F.bizflowApi,N=F.flowDataServicesProvider,k=F.crossDomainManager,R=F.timerManager,I=A.SHIELD.INSTANCE_PARAMS;return v=g&&g.timeoutSeconds?1e3*g.timeoutSeconds:l.f,new e((function(e,t){o=function(e,t,n,r){var i=a.b.deps,o=i.flowDataServicesProvider,u=i.flowsManager,d=i.timerManager,h=i.crossDomainManager,g=i.hostData,v=new c.a(".shield-events"),w=a.b.getEventServerUrl(),y=new p.WmCurator("shield",w,"end-user");return v.onEvent(n.EVENTS.ReleaseAllElementsCalled,(function(){s.a.debug(r,l.d.FEATURES.PLAY,"ReleaseAllElementsCalled was called, pausing shield"),u.stopAllFlowEventsPropagation(e),o.getFlowsPlayer(e).pause()})),v.onShieldEventsOnce([n.EVENTS.Flows.FlowStarted,n.EVENTS.Flows.RestoringFlow],(function(){var i;s.a.debug(r,l.d.FEATURES.PLAY,"shield test started or restored"),y.actionStart(l.a.TEST_RUNNING),function(e,t,n){n.onShieldEvents([t.EVENTS.Flows.AfterCompletingFlowStage,t.EVENTS.Flows.FlowStageSkipped],(function(){T()}))}(0,n,v),function(e,t,n,r,i){t.onShieldEvent(e.EVENTS.Flows.BeforeExecutingFlowStage,(function(){m(n,r,i)}))}(n,v,d,o,e),v.onShieldEventOnce(n.EVENTS.Flows.FlowPaused,(function(){y.actionEnd(l.a.TEST_RUNNING,{endReason:"flow paused"}),s.a.info(r,l.d.FEATURES.PLAY,"shield test paused. completing shield with switchedContext = true"),S(r,v,t,{switchedContext:!0})})),v.onShieldEventOnce(n.EVENTS.Flows.FlowAborted,(function(){y.actionEnd(l.a.TEST_RUNNING,{endReason:"flow aborted"}),s.a.info(r,l.d.FEATURES.PLAY,"shield test aborted. completing shield with success = false"),S(r,v,t,{success:!1})})),v.onShieldEventOnce(n.EVENTS.Flows.FlowStopped,(function(){y.actionEnd(l.a.TEST_RUNNING,{endReason:"flow stopped"}),s.a.info(r,l.d.FEATURES.PLAY,"shield test stopped. completing shield with success = false"),S(r,v,t,{success:!1},!1,(function(){a.b.deps.ownershipManagerProvider.isAnyoneElseRunning(e).length||h.get().reset()}))})),v.onShieldEvent(n.EVENTS.Flows.LookingForElement,(function(){y.actionStart(l.a.LOOKING_FOR_ELEMENT)})),v.onShieldEvent(n.EVENTS.Flows.UiElementFound,(function(e,t){y.actionEnd(l.a.LOOKING_FOR_ELEMENT),g.isIEBrowser()||f.a.create({element:t.siteElement,animationPercentBeforeRelease:70,rgb:[167,111,205]},r)})),v.onShieldEvent(n.EVENTS.Flows.BeforeExecutingFlowStage,(function(){y.actionStart(l.a.STEP_EXECUTION)})),v.onShieldEventOnce(n.EVENTS.Flows.FlowCompleted,(function(){y.actionEnd(l.a.TEST_RUNNING,{endReason:"flow completed"}),s.a.info(r,l.d.FEATURES.PLAY,"shield test completed. completing shield with success = true"),S(r,v,t,{success:!0},!0,(function(){a.b.deps.ownershipManagerProvider.isAnyoneElseRunning(e).length||h.get().loseOwnership()}))})),v.onShieldEvent(n.EVENTS.Flows.ExecutingOnPageAction,(function(){i=E.a.create()})),v.onShieldEvent(n.EVENTS.Flows.AfterCompletingFlowStage,(function(){y.actionEnd(l.a.STEP_EXECUTION),i&&(i.clean(),i=void 0)}))})),v}(I,e,A,h);try{m(R,N,I),r?N.getFlowStack(I).isEmpty()?(s.a.info(h,l.d.FEATURES.PLAY,"nothing to restore, completing shield with success = true"),S(h,o,e,{success:!0},!0,(function(){k.get().loseOwnership()}))):(u.a.setItem(l.h,!0),d.a().then((function(){if(!w())return s.a.info(h,l.d.FEATURES.PLAY,"shield play stopped before restoring"),y(),e({success:!1});s.a.info(h,l.d.FEATURES.PLAY,"shield restoring after getting green light"),b.restore(I)}))):(u.a.setItem(l.h,!0),d.a().then((function(){if(!w())return s.a.info(h,l.d.FEATURES.PLAY,"shield play stopped before starting"),y(),e({success:!1});s.a.info(h,l.d.FEATURES.PLAY,"shield playing after getting green light"),b.start(n,i,void 0,I)})))}catch(e){s.a.error(h,l.d.FEATURES.PLAY,"error in trying to play shield test",e),y(),t(e)}}))},destroy:y}}).call(this,n(3).Promise)},98:function(e,t,n){"use strict";(function(e,r){var i=n(34),o=n(5),s=n(17),a=n(0),c=n(99),l=n.n(c);function u(t,n,r,i,o,s,a){try{var c=t[s](a),l=c.value}catch(e){return void r(e)}c.done?n(l):e.resolve(l).then(i,o)}function d(){var t;return t=r.mark((function e(t,n){var c,u,d;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=o.b.deps.timerManager,u=t.animationPercentBeforeRelease/100,d=u>0?i.a.create():void 0,e.prev=4,e.next=7,l.a.create(t,c);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),s.a.error(n,a.d.FEATURES.PLAY,"error creating ripple",e.t0);case 12:return e.prev=12,d&&d.clean(),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[4,9,12,15]])})),(d=function(){var n=this,r=arguments;return new e((function(e,i){var o=t.apply(n,r);function s(t){u(o,e,i,s,a,"next",t)}function a(t){u(o,e,i,s,a,"throw",t)}s(void 0)}))}).apply(this,arguments)}t.a={create:function(e,t){return d.apply(this,arguments)}}}).call(this,n(3).Promise,n(12))}}]);